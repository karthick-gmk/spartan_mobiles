{%block content%}
{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SPARTANS - Reset Password</title>
  <link rel="icon" href="{% static 'img/title-logo.png' %}" type="image/x-icon">
  <link rel="stylesheet" href="{% static 'reset_pw.css' %}" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

<main class="card">
  <aside class="card__aside">
    <div class="brand">
      <div class="logo">SP</div>
      <div>
        <div style="font-size:12px;opacity:.9">Welcome to</div>
        <div style="font-size:18px;font-weight:700;">SPARTANS</div>
      </div>
    </div>

    <h2 style="font-size:20px;font-weight:700;">Reset your password</h2>
    <p style="font-size:14px;opacity:.9;">
      Enter your new password below. Make sure it is strong and secure.
    </p>
  </aside>

  <section class="card__body">
    <div class="head">
      <h2>Reset Password</h2>
      <p>Set a new password for your account</p>
    </div>

    <form method="post" onsubmit="return resetSubmit(event)" novalidate>
      {% csrf_token %}
      <div>
        <label for="newpass">New Password</label>
        <div>
          <div class="password-input-container">
            <input style="margin-bottom:8px;" type="password" id="password" name="password" placeholder="Enter your password" autocomplete="off">
            <button id="togglePassword" class="toggle-password" type="button">
                      <i class="fas fa-eye"></i>
            </button>
          </div> 
          <div class="strength-meter">
                <div class="strength-meter-fill" data-strength="0"></div>
          </div>
          <div class="strength-text">
                <span id="strengthText"></span>
          </div>
         <ul style="list-style: none;">
              <li id="length" class="requirement">
                  <i class="fas fa-circle"></i>
                  At least 8 characters
              </li>
              <li id="uppercase" class="requirement">
                  <i class="fas fa-circle"></i>
                  One uppercase letter
              </li>
              <li id="lowercase" class="requirement">
                  <i class="fas fa-circle"></i>
                  One lowercase letter
              </li>
              <li id="number" class="requirement">
                  <i class="fas fa-circle"></i>
                  One number
              </li>
              <li id="special" class="requirement">
                  <i class="fas fa-circle"></i>
                  One special character
              </li>
          </ul>
        </div>
        <!-- Confirm Password -->
        <div>
          <label for="confirmPassword">Confirm Password</label>
          <div class="password-input-container">
            <input style="margin-bottom:8px;" id="confirmPassword" name="cpassword" type="password" placeholder="Confirm password" required  autocomplete="off"/>
            <button id="toggleConfirmPassword" class="toggle-password" type="button">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          <div id="passwordMismatchError" style="color:red; font-size:12px; display:none;">
            Passwords do not match
          </div>
        </div>
      </div>

      <button type="submit" class="btn">
          Update Password
      </button>

      <div class="note-link">
        Remembered? <a href="/sign_in">Sign in</a>
      </div>

    </form>
  </section>
</main>




<style>
  :root{
      --bg:#f4f7fb;
      --card:#ffffff;
      --accent:#111827;
      --muted:#6b7280;
      --radius:12px;
      --shadow:0 6px 20px rgba(16,24,40,0.08);
      font-family: Inter, system-ui, sans-serif;
    }
  :root {
      --primary-color: #4a90e2;
      --success-color: #2ecc71;
      --warning-color: #f1c40f;
      --danger-color: #e74c3c;
      --text-color: #2c3e50;
      --bg-color: #f5f6fa;
      --card-bg: #ffffff;
      --border-radius: 12px;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      --gradient-primary: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
      --gradient-success: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
      --gradient-warning: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
      --gradient-danger: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
  }  

  .requirements {
      margin-bottom: var(--spacing-lg);
  }

  .requirements ul {
      list-style: none;
  }

  .requirement {
      display: flex;
      align-items: center;
      color: #666;
      transition: all 0.3s ease;
      border-radius: var(--border-radius);
      font-size: small;
  }

  .requirement:hover {
      background-color: #f8f9fa;
  }

  .requirement i {
      margin-right: var(--spacing-sm);
      font-size: 0.5rem;
      transition: all 0.3s ease;
      margin-left:-45px ;
  }

  .requirement.valid {
      color: var(--success-color);
      background-color: rgba(46, 204, 113, 0.1);
  }

  .requirement.valid i {
      color: var(--success-color);
      transform: scale(1.2);
  }

  .strength-text {
      text-align: left;
      margin-bottom: var(--spacing-lg);
      font-weight: 400;
  }
  .password-input-container {
      position: relative;
      margin-bottom: var(--spacing-md);
  }
  .toggle-password {
      position: absolute;
      right: var(--spacing-md);
      top: 45%;
      left: 80%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      padding: var(--spacing-sm);
      transition: color 0.3s ease;
  }

  .toggle-password:hover {
      color: var(--primary-color);
  }

  .strength-meter {
      height: 6px;
      background-color: #eee;
      border-radius: 3px;
      margin-bottom: var(--spacing-sm);
      overflow: hidden;
  }

  .strength-meter-fill {
      height: 100%;
      width: 0;
      border-radius: 3px;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .strength-meter-fill[data-strength="0"] { width: 0; background-color: transparent; }
  .strength-meter-fill[data-strength="1"] { width: 25%; background: var(--gradient-danger); }
  .strength-meter-fill[data-strength="2"] { width: 50%; background: var(--gradient-warning); }
  .strength-meter-fill[data-strength="3"] { width: 75%; background: var(--gradient-primary); }
  .strength-meter-fill[data-strength="4"] { width: 100%; background: var(--gradient-success); }

      *{ box-sizing:border-box; }

      body{
        margin:0;
        min-height:100vh;
        display:flex;
        align-items:center;
        justify-content:center;
        padding:28px;
        background:linear-gradient(180deg,var(--bg),#eef2ff);
        color:#111827;
      }

      .card{
        width:100%;
        max-width:880px;
        background:var(--card);
        border-radius:var(--radius);
        box-shadow:var(--shadow);
        display:grid;
        grid-template-columns:380px 1fr;
        overflow:hidden;
      }

      /* LEFT SIDE (Brand) */
      .card__aside{
        background:linear-gradient(180deg,rgba(17,24,39,0.98),rgba(31,41,55,0.95));
        color:white;
        padding:28px;
        display:flex;
        flex-direction:column;
        justify-content:center;
        gap:18px;
      }

      .logo{
        width:54px;height:54px;border-radius:10px;
        background:linear-gradient(135deg,#ef4444,#b91c1c);
        display:flex;align-items:center;justify-content:center;
        font-weight:700;font-size:20px;color:white;
        box-shadow:0 8px 30px rgba(185,28,28,0.2);
      }

      .brand-text{
        margin:0;
        font-weight:700;
        font-size:22px;
        letter-spacing:1px;
      }

      .desc{font-size:14px;opacity:.92;line-height:1.5;}

      /* RIGHT SIDE (Form) */
      .card__body{padding:28px;}

      h2{margin:0 0 4px;font-size:22px;}
      p{margin:0;color:var(--muted);font-size:14px;}

      form{
        margin-top:18px;
        display:flex;
        flex-direction:column;
        gap:16px;
      }

      label{
        font-size:13px;
        margin-bottom:4px;
        color:var(--muted);
      }

      input{
        width:100%;
        padding:12px 14px;
        border:1px solid #e5e7eb;
        border-radius:10px;
        font-size:14px;
        outline:none;
        transition:border-color .15s,box-shadow .15s;
      }

      input:focus{
        border-color:var(--accent);
        box-shadow:0 0 0 4px rgba(17,24,39,0.08);
      }

      .btn{
        padding:12px;
        border:none;
        border-radius:10px;
        background:var(--accent);
        color:white;
        font-weight:600;
        cursor:pointer;
        font-size:15px;
        box-shadow:0 6px 14px rgba(17,24,39,0.1);
      }

      .link{
        color:blue;
        text-decoration:none;
        font-size:14px;
        font-weight:600;
      }

      .small-center{
        text-align:center;
        margin-top:10px;
        font-size:14px;
        color:var(--muted);
      }

      @media(max-width:880px){
        .card{grid-template-columns:1fr;}
      } 
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
      const passwordInput = document.getElementById('password');
      const confirmPasswordInput = document.getElementById('confirmPassword');
      const form = document.querySelector('form');
      const submitBtn = document.querySelector('.btn[type="submit"]');

      // Disable submit button initially
      submitBtn.disabled = true;
      submitBtn.style.opacity = "0.5";
      submitBtn.style.cursor = "not-allowed";

      function enableSubmitIfValid() {
          if (form.checkValidity()) {
              submitBtn.disabled = false;
              submitBtn.style.opacity = "1";
              submitBtn.style.cursor = "pointer";
          } else {
              submitBtn.disabled = true;
              submitBtn.style.opacity = "0.5";
              submitBtn.style.cursor = "not-allowed";
          }
      }

      const togglePassword = document.getElementById('togglePassword');
      const strengthMeter = document.querySelector('.strength-meter-fill');
      const strengthText = document.getElementById('strengthText');

      const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');

      const requirements = {
          length: document.getElementById('length'),
          uppercase: document.getElementById('uppercase'),
          lowercase: document.getElementById('lowercase'),
          number: document.getElementById('number'),
          special: document.getElementById('special')
      };

          // Password matching validation
      confirmPasswordInput.addEventListener('input', () => {
          const password = passwordInput.value;
          const confirmPassword = confirmPasswordInput.value;
          const errorDiv = document.getElementById('passwordMismatchError');
          
          if (confirmPassword && password !== confirmPassword) {
              confirmPasswordInput.setCustomValidity('Passwords do not match');
              errorDiv.style.display = 'block';
              confirmPasswordInput.style.borderColor = 'red';
          } else {
              confirmPasswordInput.setCustomValidity('');
              errorDiv.style.display = 'none';
              confirmPasswordInput.style.borderColor = '';
          }

          enableSubmitIfValid();
      });


      // Toggle password visibility
      togglePassword.addEventListener('click', (e) => {
          e.preventDefault();
          const type = passwordInput.type === 'password' ? 'text' : 'password';
          passwordInput.type = type;
          togglePassword.querySelector('i').classList.toggle('fa-eye');
          togglePassword.querySelector('i').classList.toggle('fa-eye-slash');
      });

      // Toggle confirm password visibility
      toggleConfirmPassword.addEventListener('click', (e) => {
          e.preventDefault();
          const type = confirmPasswordInput.type === 'password' ? 'text' : 'password';
          confirmPasswordInput.type = type;
          toggleConfirmPassword.querySelector('i').classList.toggle('fa-eye');
          toggleConfirmPassword.querySelector('i').classList.toggle('fa-eye-slash');
      });

      // Check password strength
      passwordInput.addEventListener('input', () => {
          const password = passwordInput.value;
          let strength = 0;
          let validRequirements = 0;

          // Check length
          if (password.length >= 8) { requirements.length.classList.add('valid'); validRequirements++; }
          else { requirements.length.classList.remove('valid'); }

          // Uppercase
          if (/[A-Z]/.test(password)) { requirements.uppercase.classList.add('valid'); validRequirements++; }
          else { requirements.uppercase.classList.remove('valid'); }

          // Lowercase
          if (/[a-z]/.test(password)) { requirements.lowercase.classList.add('valid'); validRequirements++; }
          else { requirements.lowercase.classList.remove('valid'); }

          // Number
          if (/[0-9]/.test(password)) { requirements.number.classList.add('valid'); validRequirements++; }
          else { requirements.number.classList.remove('valid'); }

          // Special char
          if (/[^A-Za-z0-9]/.test(password)) { requirements.special.classList.add('valid'); validRequirements++; }
          else { requirements.special.classList.remove('valid'); }

          // Strength logic
          if (password.length > 0) {
              strength = Math.min(4, Math.floor(validRequirements * 0.8));
          }

          strengthMeter.setAttribute('data-strength', strength);

          switch (strength) {
              case 0: strengthText.textContent = 'Enter a password'; strengthText.style.color = '#666'; break;
              case 1: strengthText.textContent = 'Very Weak'; break;
              case 2: strengthText.textContent = 'Weak'; break;
              case 3: strengthText.textContent = 'Strong'; break;
              case 4: strengthText.textContent = 'Very Strong'; break;
          }

          enableSubmitIfValid();
      });

      // Check all form inputs on typing
      document.querySelectorAll('input').forEach(input => {
          input.addEventListener('input', enableSubmitIfValid);
      });
  });
</script>

</body>
</html>
{%endblock%}